# Dataset Details

The original dataset is composed of originally stored in an Elasticsearch Cluster.

The following filters were used to obtain the presented raw logs:
- Remove logs generated by filebeat, packetbeat, metricbeat, and auditbeat agents.
- Include logs from /var/log/syslog only.
- Include only unstructured logs (Not processed by Filebeat's system module).
- Include only logs collected from systems running under normal operations.
- Include logs generated by VMs from the ITESM cluster.
- Exclude messages generated by the kernel ring buffer which can also be found in dmesg and kern.log
- Exclude long log messages not providing substantial system information. These were mostrly produced by our collection agents and can be identified using the command below. These long messages were identified after processing a log file joining normal and abnormal logs of interest.
  Command for Identifying Long log Messages: "awk '{print length, $0}' linux_log_file.log |sort -nr|head -20"
  [excluded_logs_examples.log] (https://github.com/cyberthreat-datasets/ctdd-2021-os-syslogs/tree/main/CTDD_Dataset/normal/itesm/excluded_logs_examples.log)

KQL Search:"NOT (message: filebeat OR message: packetbeat OR message: metricbeat OR message: auditbeat) AND log.file.path: /var/log/syslog AND NOT event.module: * AND (_index: filebeat-7*) AND dataset.label: normal AND host.name: itesm*
